from aiogram.dispatcher.middlewares import BaseMiddleware

# In main.py
# ...
from bot.middlewares.db import DbSessionMiddleware
from bot.middlewares.i18n import I18nMiddleware

# ... inside main() function ...
    # dp.update.middleware(DbSessionMiddleware()) 
    # ^ Not exactly right in aiogram 3.x, it uses outer_middleware for session usually
    
    dp.update.outer_middleware(DbSessionMiddleware())
    dp.message.middleware(I18nMiddleware())
    dp.callback_query.middleware(I18nMiddleware())
